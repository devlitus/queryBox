---
import plusIcon from "../../assets/icons/plus.svg?raw";
---

<pm-tabs class="block">
	<div
		class="flex items-center justify-between border-b border-pm-border"
		role="tablist"
	>
		<div class="flex overflow-x-scroll tabs-container">
			<button
				type="button"
				class="px-4 py-2 text-sm font-medium text-pm-text-primary border-b-2 border-pm-accent active tab-button"
				role="tab"
				data-tab="collections"
				aria-selected="true"
				aria-controls="tabpanel-collections"
				tabindex="0"
			>
				Collections
			</button>
			<button
				type="button"
				class="px-4 py-2 text-sm font-medium text-pm-text-secondary hover:text-pm-text-primary border-b-2 border-transparent tab-button"
				role="tab"
				data-tab="environments"
				aria-selected="false"
				aria-controls="tabpanel-environments"
				tabindex="-1"
			>
				Environments
			</button>
			<button
				type="button"
				class="px-4 py-2 text-sm font-medium text-pm-text-secondary hover:text-pm-text-primary border-b-2 border-transparent tab-button"
				role="tab"
				data-tab="history"
				aria-selected="false"
				aria-controls="tabpanel-history"
				tabindex="-1"
			>
				History
			</button>
		</div>
		<button
			type="button"
			class="w-8 h-8 mr-2 inline-flex items-center justify-center rounded hover:bg-pm-bg-elevated transition-colors text-pm-text-secondary"
			aria-label="Create new"
		>
			<div class="w-4 h-4" aria-hidden="true">
				<Fragment set:html={plusIcon} />
			</div>
		</button>
	</div>

	<slot />
</pm-tabs>

<script>
	import "../../scripts/tabs.ts";
</script>

<style>
	button[data-tab].active {
		color: var(--color-pm-text-primary);
		border-color: var(--color-pm-accent);
	}

	.tabs-container {
		scroll-behavior: smooth;
		scrollbar-width: none;
		-ms-overflow-style: none;
	}

	.tabs-container::-webkit-scrollbar {
		display: none;
	}
</style>

<script>
	const tabButtons = document.querySelectorAll(".tab-button");
	const tabsContainer = document.querySelector(".tabs-container") as HTMLElement;

	tabButtons.forEach((button) => {
		button.addEventListener("click", () => {
			if (!tabsContainer) return;

			const buttonEl = button as HTMLElement;
			const buttonWidth = buttonEl.offsetWidth;
			const containerWidth = tabsContainer.clientWidth;
			const buttonLeft = buttonEl.offsetLeft;

			// Calcular el scroll necesario para centrar el bot√≥n
			const targetScroll = buttonLeft - (containerWidth - buttonWidth) / 2;

			tabsContainer.scrollTo({
				left: targetScroll,
				behavior: "smooth",
			});
		});
	});
</script>
